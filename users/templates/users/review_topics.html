{% extends "main.html" %} {% block head %}
<style>
  .clickable-card {
    cursor: pointer;
    height: 100%;
    display: flex;
    flex-direction: column;
  }

  .card-body {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
  }

  .card-content {
    flex-grow: 1;
  }

  .card-footer {
    margin-top: 10px;
  }

  .card-buttons {
    display: flex;
    justify-content: space-between;
    margin-top: 10px;
  }

  .textarea-comment {
    resize: none;
  }
</style>

{% endblock %} {% block content %}
<div class="body flex-grow-1 px-3">
  <div class="container-lg">
    <div class="card mb-4">
      <div class="card-header">
        <strong>{{submission_data.submission_title}}</strong>
      </div>
      <div class="card-body">
        <div class="example">
          <div class="tab-content rounded-bottom">
            <div
              class="tab-pane p-3 active preview"
              role="tabpanel"
              id="preview-946"
            >
              <div class="row">
                {% for topic_value in topics %}
                <div class="col-xl-4 mb-4">
                  <div class="card text-white bg-info clickable-card">
                    <div class="card-header">{{submission_data.research_work.name}}</div>
                    <div class="card-body d-flex flex-column">
                      <h5 class="card-title">{{topic_value.topic.name}}</h5>

                      {% if topic_value.files and topic_value.files|length > 0 %}
                      {% with last_file=topic_value.files|last %}
                        <a href="http://89.150.34.163:8000/api/v1/student/download/{{ last_file.id }}" class="btn btn-light my-2" target="_blank">
                          Скачать файл
                        </a>
                      {% endwith %}
                      {% else %}
                      <p class="text-white text-center">Файл отсутствует</p>
                      {% endif %}
                      
                      <div class="card-footer">
                      <form method="POST" action="#">
                        {% csrf_token %}
                        <input type="hidden" name="submission_topic_id" value="{{ topic_value.id }}">
                        <textarea class="form-control textarea-comment mb-2" name="comment" placeholder="Комментарий" {% if not topic_value.files %}disabled{% endif %}></textarea>
                        <div class="d-flex justify-content-between">
                          <button type="submit" name="action" value="accept" class="btn btn-success btn-sm" {% if not topic_value.files %}disabled{% endif %}>Принять</button>
                          <button type="submit" name="action" value="reject" class="btn btn-danger btn-sm" {% if not topic_value.files %}disabled{% endif %}>Отклонить</button>
                        </div>
                      </form>
                    </div>
                    </div>
                  </div>
                </div>
                {% endfor %}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- <script>
  document.addEventListener("DOMContentLoaded", function () {
    const clickableCards = document.querySelectorAll(".clickable-card");
    clickableCards.forEach((card) => {
      card.addEventListener("click", function () {
        window.location.href = this.getAttribute("data-href");
      });
    });
  });
</script> -->
{% endblock content %}
